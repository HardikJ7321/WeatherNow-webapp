let classAdded="",autoDetectLoc=1;const api={key:"eec70ae71d64dc37c3b1ff96428e5853",base:"https://api.openweathermap.org/data/2.5/"};function getLocation(){function e(){document.querySelector(".current .temp").innerHTML="",document.querySelector(".current .weather").innerHTML="Meanwhile search for other cities ...",document.querySelector(".current .hilow").innerHTML="Cannot detect your location.<br>Please allow to access location.",document.querySelector(".current .wind span").innerHTML="",document.querySelector(".current .humidity span").innerHTML="",document.querySelector(".location .city").innerHTML="",document.querySelector(".location .date").innerHTML=""}autoDetectLoc=1,navigator.geolocation.getCurrentPosition(function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):e()},e)}function showPosition(e){let t=e.coords.latitude,n=e.coords.longitude;fetch(`${api.base}weather?lat=${t}&lon=${n}&units=metric&appid=${api.key}`).then(e=>e.json()).then(displayResults)}function setQuery(e){13!=e.keyCode&&"click"!=e.type&&"touchstart"!=e.type||""==searchbox.value||getResults(searchbox.value)}function titleCase(e){for(var t=e.toLowerCase().split(" "),n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].substring(1);return t.join(" ")}async function getResults(e){let t=titleCase(e);(await fetch(`${api.base}weather?q=${t}&units=metric&APPID=${api.key}`)).ok?fetch(`${api.base}weather?q=${t}&units=metric&APPID=${api.key}`).then(e=>e.json()).then(displayResults):console.log(`${e} does not exist`)}function displayResults(e){$("body").hasClass(classAdded)&&$("body").removeClass(classAdded),$(".card").hasClass(classAdded+"-card")&&$(".card").removeClass(classAdded+"-card"),document.querySelector(".location .city").innerText=`${e.name}, ${e.sys.country}`;let t=new Date;document.querySelector(".location .date").innerText=dateBuilder(t),document.querySelector(".current .temp").innerHTML=`${Math.round(e.main.temp)}<span>°c</span>`,document.querySelector(".current .weather").innerText=e.weather[0].main,document.querySelector(".current .wind span").innerText=`  ${Math.round(3.6*e.wind.speed)} km/h`,document.querySelector(".current .humidity span").innerText=`  ${e.main.humidity} %`,document.querySelector(".current .hilow").innerText=`${Math.round(e.main.temp_min)}°c / ${Math.round(e.main.temp_max)}°c`;let n=t.getHours(),r=e.weather[0].id.toString();classAdded="800"==r?n>=18||n<=4?"clearn":"cleard":"8"==r[0]?"cloud":"2"==r[0]||"3"==r[0]||"5"==r[0]?"rain":"6"==r[0]?"snow":"sand",$("body").addClass(classAdded),$(".card").addClass(classAdded+"-card")}function dateBuilder(e){return`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]} ${e.getDate()} ${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${e.getFullYear()}`}$(window).on("load",getLocation);const searchbox=document.querySelector(".search-box");searchbox.addEventListener("keypress",setQuery);const searchbutton=document.querySelector(".search-container .btn");searchbutton.addEventListener("click",setQuery),searchbutton.addEventListener("touchstart",setQuery);
